<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Margin Analysis - Strategic Dashboard</title>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
        }

        .container-like {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            padding: 40px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Alert Banner - Image style */
        .alert-banner {
            background: white;
            border: 3px solid #dc2626;
            color: #1f2937;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .alert-banner h2 {
            font-size: 1.8em;
            margin-bottom: 12px;
            font-weight: bold;
            color: #dc2626;
            letter-spacing: 0.5px;
        }

        .alert-banner p {
            font-size: 1.1em;
            margin: 8px 0;
            font-weight: 600;
            color: #1f2937;
        }

        .alert-banner p:last-child {
            font-size: 0.95em;
            font-weight: 500;
            color: #4b5563;
        }

        /* Metrics Grid - Image style with colored borders */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .metric-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            border-left: 5px solid;
            position: relative;
        }

        .metric-card.purple { border-left-color: #7b2cbf; }
        .metric-card.red { border-left-color: #dc2626; }
        .metric-card.green { border-left-color: #059669; }
        .metric-card.orange { border-left-color: #ea580c; }

        .metric-label {
            font-size: 0.75em;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 8px;
            line-height: 1;
        }

        .metric-card.purple .metric-value { color: #7b2cbf; }
        .metric-card.red .metric-value { color: #dc2626; }
        .metric-card.green .metric-value { color: #059669; }
        .metric-card.orange .metric-value { color: #ea580c; }

        .metric-change {
            font-size: 0.9em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
            color: #dc2626;
        }

        /* Accordion "How is it calculated?" */
        .accordion {
            background: #eff6ff;
            border: 2px solid #3b82f6;
            border-radius: 12px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .accordion-header {
            padding: 18px 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
            font-size: 1.05em;
            color: #1e40af;
            transition: background 0.2s;
        }

        .accordion-header:hover {
            background: #dbeafe;
        }

        .accordion-icon {
            width: 40px;
            height: 40px;
            background: #3b82f6;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2em;
            flex-shrink: 0;
        }

        .accordion-arrow {
            margin-left: auto;
            font-size: 1.2em;
            transition: transform 0.3s;
        }

        .accordion.open .accordion-arrow {
            transform: rotate(180deg);
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease;
            border-top: 1px solid #bfdbfe;
        }

        .accordion.open .accordion-content {
            max-height: 1200px;
        }

        .accordion-inner {
            padding: 30px;
            background: white;
            border-left: 4px solid #3b82f6;
        }

        .explanation-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #1e40af;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .explanation-description {
            color: #1e40af;
            line-height: 1.7;
            margin-bottom: 25px;
            font-size: 0.95em;
        }

        .calculation-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 25px;
        }

        .calculation-steps {
            background: #f9fafb;
            padding: 25px;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
        }

        .step {
            margin-bottom: 20px;
        }

        .step:last-child {
            margin-bottom: 0;
        }

        .step-title {
            font-weight: bold;
            color: #374151;
            margin-bottom: 8px;
            border-bottom: 2px solid #d1d5db;
            padding-bottom: 6px;
        }

        .step-content {
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #6b7280;
            padding: 8px 0;
        }

        .step:last-child .step-title {
            color: #dc2626;
            border-bottom-color: #fca5a5;
        }

        .step:last-child .step-content {
            color: #dc2626;
            font-weight: bold;
            font-size: 1.05em;
        }

        .visual-comparison {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 20px;
        }

        .comparison-bar {
            margin-bottom: 15px;
        }

        .comparison-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.85em;
            font-weight: 600;
            color: #4b5563;
            margin-bottom: 6px;
        }

        .bar-container {
            width: 100%;
            height: 32px;
            background: #e5e7eb;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }

        .bar-fill {
            height: 100%;
            border-radius: 20px;
            transition: width 0.6s ease;
        }

        .bar-fill.green {
            background: linear-gradient(90deg, #059669 0%, #10b981 100%);
        }

        .bar-fill.red {
            background: linear-gradient(90deg, #dc2626 0%, #ef4444 100%);
            position: relative;
        }

        .bar-gap {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            background: repeating-linear-gradient(
                45deg,
                #f3f4f6,
                #f3f4f6 10px,
                #d1d5db 10px,
                #d1d5db 20px
            );
            border-left: 2px dashed #6b7280;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75em;
            font-weight: bold;
            color: #4b5563;
        }

        .breakdown-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .breakdown-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .breakdown-icon {
            width: 36px;
            height: 36px;
            background: #dbeafe;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #3b82f6;
            font-size: 1.2em;
            flex-shrink: 0;
        }

        .breakdown-value {
            font-weight: bold;
            color: #1f2937;
            font-size: 0.95em;
        }

        .final-note {
            background: #dbeafe;
            padding: 18px;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
            color: #1e40af;
            font-size: 0.9em;
            line-height: 1.6;
            font-style: italic;
            margin-top: 20px;
        }

        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }

        .chart-title {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
        }

        .table-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: linear-gradient(135deg, #7b2cbf 0%, #5a189a 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 1px;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #e5e7eb;
        }

        tr:hover {
            background-color: #f9fafb;
        }

        .highlight-row {
            background-color: #fef3c7;
            font-weight: 600;
        }

        .number {
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        .negative-value {
            color: #dc2626;
        }

        .positive-value {
            color: #059669;
        }

        .section-title {
            font-size: 1.8em;
            color: #7b2cbf;
            margin: 40px 0 20px 0;
            font-weight: bold;
            border-left: 5px solid #7b2cbf;
            padding-left: 15px;
        }

        .insight-box {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-left: 5px solid #f59e0b;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .insight-box h3 {
            color: #92400e;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .insight-box p {
            color: #78350f;
            line-height: 1.6;
        }

        .priority-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            border-left: 6px solid;
        }

        .priority-1 { 
            border-left-color: #dc2626; 
            background: linear-gradient(135deg, #ffffff 0%, #fee2e2 100%); 
        }

        .priority-2 { 
            border-left-color: #ea580c; 
            background: linear-gradient(135deg, #ffffff 0%, #ffedd5 100%); 
        }

        .priority-3 { 
            border-left-color: #7b2cbf; 
            background: linear-gradient(135deg, #ffffff 0%, #f3e8ff 100%); 
        }

        .control { 
            border-left-color: #059669; 
            background: linear-gradient(135deg, #ffffff 0%, #d1fae5 100%); 
        }

        .priority-header { 
            margin-bottom: 25px; 
            display: flex; 
            align-items: center; 
            gap: 15px; 
        }

        .priority-badge {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.75em;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .priority-2 .priority-badge { 
            background: linear-gradient(135deg, #ea580c 0%, #c2410c 100%); 
        }

        .priority-3 .priority-badge { 
            background: linear-gradient(135deg, #7b2cbf 0%, #5a189a 100%); 
        }

        .control-badge { 
            background: linear-gradient(135deg, #059669 0%, #047857 100%); 
        }

        .action-item {
            display: flex;
            gap: 20px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 15px;
        }

        .action-number {
            min-width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #7b2cbf 0%, #5a189a 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
            flex-shrink: 0;
        }

        .action-content h4 {
            color: #333;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .action-content p, .action-content ul {
            color: #666;
            line-height: 1.6;
            font-size: 0.95em;
        }

        .action-content ul {
            margin-left: 20px;
            margin-top: 5px;
            list-style-type: disc;
        }

        .timeline-section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }

        .timeline {
            position: relative;
            padding: 20px 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(to bottom, #7b2cbf, #059669);
            transform: translateX(-50%);
        }

        .timeline-item {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 30px;
            margin-bottom: 40px;
            align-items: start;
        }

        .timeline-item:nth-child(even) .timeline-content {
            grid-column: 1;
            text-align: right;
        }

        .timeline-item:nth-child(odd) .timeline-content {
            grid-column: 3;
            text-align: left;
        }

        .timeline-marker {
            grid-column: 2;
            background: white;
            border: 4px solid;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9em;
            color: white;
            position: relative;
            z-index: 2;
        }

        .week1-2 { 
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%); 
            border-color: #dc2626; 
        }

        .week3-4 { 
            background: linear-gradient(135deg, #ea580c 0%, #c2410c 100%); 
            border-color: #ea580c; 
        }

        .month2 { 
            background: linear-gradient(135deg, #7b2cbf 0%, #5a189a 100%); 
            border-color: #7b2cbf; 
        }

        .month3 { 
            background: linear-gradient(135deg, #059669 0%, #047857 100%); 
            border-color: #059669; 
        }

        .timeline-content {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.08);
        }

        .timeline-content h4 {
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .timeline-content ul {
            list-style-type: disc;
            margin-left: 20px;
            color: #666;
            line-height: 1.6;
        }

        .final-warning {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            border: 3px solid #dc2626;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            text-align: center;
        }

        .final-warning h3 {
            color: #7f1d1d;
            margin-bottom: 15px;
            font-size: 1.5em;
            font-weight: bold;
        }

        .final-warning p {
            color: #7f1d1d;
            line-height: 1.8;
        }

        @media (max-width: 768px) {
            .calculation-grid {
                grid-template-columns: 1fr;
            }

            .breakdown-grid {
                grid-template-columns: 1fr;
            }

            .timeline::before {
                left: 40px;
                transform: none;
            }

            .timeline-item {
                grid-template-columns: 80px 1fr;
                gap: 15px;
            }

            .timeline-item:nth-child(even) .timeline-content,
            .timeline-item:nth-child(odd) .timeline-content {
                grid-column: 2;
                text-align: left;
            }

            .timeline-marker {
                grid-column: 1;
            }
        }
    </style>
</head>
<body>
    <div class="container-like">
        
        <div class="alert-banner">
            <h2>GENERAL SITUATION</h2>
            <p>Margin decline: -15.98 percentage points</p>
            <p>Current margin 45.60% - Below the healthy threshold of 50%</p>
        </div>
        
        <div class="metrics-grid">
            <div class="metric-card purple">
                <div class="metric-label">AVERAGE MARGIN PER KG 2025</div>
                <div class="metric-value">$7.25</div>
                <div class="metric-change">‚Üì $1.70 vs 2024</div>
            </div>

            <div class="metric-card red">
                <div class="metric-label">OVERALL MARGIN % 2025</div>
                <div class="metric-value">45.6%</div>
                <div class="metric-change">‚Üì -16.0 points</div>
            </div>

            <div class="metric-card green">
                <div class="metric-label">TOTAL PROFIT 2025</div>
                <div class="metric-value">$626K</div>
                <div class="metric-change">‚Üì -7.6% vs 2024</div>
            </div>

            <div class="metric-card orange">
                <div class="metric-label">ANNUAL LOST MARGIN</div>
                <div class="metric-value">$220K</div>
                <div class="metric-change">$18.3K per month</div>
            </div>
        </div>

        <div class="accordion" id="calculationAccordion">
            <div class="accordion-header" onclick="toggleAccordion()">
                <div class="accordion-icon">üìä</div>
                <span>How is it calculated?</span>
                <div class="accordion-arrow">‚ñº</div>
            </div>
            <div class="accordion-content">
                <div class="accordion-inner">
                    <div class="explanation-title">
                        üí° Where does the Lost Margin of $220K come from?
                    </div>
                    <p class="explanation-description">
                        The lost margin answers this question: If you had maintained the same margin % as in 2024, how much extra money would you have today?
                    </p>

                    <div class="calculation-grid">
                        <div class="calculation-steps">
                            <div class="step">
                                <div class="step-title">STEP 1: Expected margin</div>
                                <div class="step-content">2025 Sales ($1.38M) √ó 2024 Margin (61.6%) = $846K</div>
                            </div>
                            <div class="step">
                                <div class="step-title">STEP 2: Actual margin</div>
                                <div class="step-content">ACTUAL Margin 2025 = $626K</div>
                            </div>
                            <div class="step">
                                <div class="step-title">STEP 3: The difference</div>
                                <div class="step-content">$846K - $626K = $220K</div>
                            </div>
                        </div>

                        <div class="visual-comparison">
                            <div class="comparison-bar">
                                <div class="comparison-label">
                                    <span>Expected margin (61.6%)</span>
                                    <span>$846K</span>
                                </div>
                                <div class="bar-container">
                                    <div class="bar-fill green" style="width: 100%;"></div>
                                </div>
                            </div>
                            <div class="comparison-bar">
                                <div class="comparison-label">
                                    <span>Actual margin (45.6%)</span>
                                    <span>$626K</span>
                                </div>
                                <div class="bar-container">
                                    <div class="bar-fill red" style="width: 74%;"></div>
                                    <div class="bar-gap" style="width: 26%;">
                                        Difference: $220K
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="breakdown-grid" style="grid-template-columns: repeat(2, 1fr);">
                        <div class="breakdown-item">
                            <div class="breakdown-icon">üìÖ</div>
                            <div class="breakdown-value">Per month: $18.3K</div>
                        </div>
                        <div class="breakdown-item">
                            <div class="breakdown-icon">üìä</div>
                            <div class="breakdown-value">Per quarter: $55K</div>
                        </div>
                    </div>

                    <div class="final-note">
                        "You're absorbing $220K in costs per year instead of passing them on to what customers pay."
                    </div>
                </div>
            </div>
        </div>

        <div class="chart-container">
            <div class="chart-title">Price vs Cost Evolution (Weighted Averages)</div>
            <div class="chart-wrapper">
                <canvas id="precioVsCostoChart"></canvas>
            </div>
        </div>
        
        <div class="insight-box">
            <h3>üí° Key Insight</h3>
            <p><strong>The gap remains significant:</strong> Coffee cost increased by +54.4% (from $5.72/kg to $8.83/kg), 
            but the selling price only increased by +9.4% (from $14.53/kg to $15.89/kg). This ~45 percentage point 
            difference that hasn't been passed on is eroding your margin.</p>
        </div>

        <div class="table-container">
            <div class="chart-title">Profit vs Cost Composition</div>
            <table>
                <thead>
                    <tr>
                        <th>Concept</th>
                        <th>Avg Price/KG</th>
                        <th>Avg Cost/KG</th>
                        <th>Margin/KG</th>
                        <th>% Margin</th>
                        <th>Total Sales</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>2024</strong></td>
                        <td class="number">$14.53</td>
                        <td class="number">$5.72</td>
                        <td class="number positive-value">$8.81</td>
                        <td class="number positive-value">61.6%</td>
                        <td class="number">$1.10M</td>
                    </tr>
                    <tr class="highlight-row">
                        <td><strong>2025</strong></td>
                        <td class="number">$15.89</td>
                        <td class="number">$8.83</td>
                        <td class="number">$7.06</td>
                        <td class="number">45.6%</td>
                        <td class="number">$1.38M</td>
                    </tr>
                    <tr>
                        <td><strong>Change</strong></td>
                        <td class="number positive-value">+9.4%</td>
                        <td class="number negative-value">+54.4%</td>
                        <td class="number negative-value">-19.9%</td>
                        <td class="number negative-value">-16.0 pts</td>
                        <td class="number positive-value">+24.6%</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h2 class="section-title">Profitability by Blend Variety</h2>

        <div class="table-container">
            <div class="chart-title">Top 5 Varieties by Absolute Profit (2025)</div>
            <table>
                <thead>
                    <tr>
                        <th>Variety / Blend</th>
                        <th>Sales</th>
                        <th>Profit $</th>
                        <th>Margin 2024</th>
                        <th>Margin 2025</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Main Street</td>
                        <td class="number">$371K</td>
                        <td class="number">$165K</td>
                        <td class="number positive-value">61.2%</td>
                        <td class="number">44.6%</td>
                    </tr>
                    <tr>
                        <td>Maestrale</td>
                        <td class="number">$327K</td>
                        <td class="number">$152K</td>
                        <td class="number positive-value">62.4%</td>
                        <td class="number">46.7%</td>
                    </tr>
                    <tr>
                        <td>Americano Blend</td>
                        <td class="number">$122K</td>
                        <td class="number">$62K</td>
                        <td class="number positive-value">62.2%</td>
                        <td class="number positive-value">50.6%</td>
                    </tr>
                    <tr>
                        <td>HLT Blend</td>
                        <td class="number">$144K</td>
                        <td class="number">$55K</td>
                        <td class="number positive-value">56.8%</td>
                        <td class="number negative-value">37.9%</td>
                    </tr>
                    <tr>
                        <td>Alis</td>
                        <td class="number">$116K</td>
                        <td class="number">$52K</td>
                        <td class="number positive-value">58.5%</td>
                        <td class="number">44.4%</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="table-container">
            <div class="chart-title">Top 5 Clients by Absolute Margin (2025)</div>
            <table>
                <thead>
                    <tr>
                        <th>Client</th>
                        <th>Sales</th>
                        <th>Margin $</th>
                        <th>Margin %</th>
                        <th>Assessment</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Hilton / CONRAD - Tulum</td>
                        <td class="number">$161K</td>
                        <td class="number">$69K</td>
                        <td class="number">42.7%</td>
                        <td>üü° Adjust - Moderate +20%</td>
                    </tr>
                    <tr>
                        <td>Ojo de Agua - CEDIS CDMX</td>
                        <td class="number">$79K</td>
                        <td class="number">$43K</td>
                        <td class="number positive-value">55.3%</td>
                        <td>üü¢ Excellent - Maintain</td>
                    </tr>
                    <tr>
                        <td>Sofitel CDMX</td>
                        <td class="number">$73K</td>
                        <td class="number">$42K</td>
                        <td class="number positive-value">57.3%</td>
                        <td>üü¢ Excellent - Maintain</td>
                    </tr>
                    <tr>
                        <td>Hilton - Mar Caribe (All-In)</td>
                        <td class="number">$99K</td>
                        <td class="number">$41K</td>
                        <td class="number">42.0%</td>
                        <td>üü° Adjust - Moderate +20%</td>
                    </tr>
                    <tr>
                        <td>Hyatt - Mexico City</td>
                        <td class="number">$83K</td>
                        <td class="number">$39K</td>
                        <td class="number">46.7%</td>
                        <td>üü° Adjust - Slight +15%</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h2 class="section-title">Suggested Action Plan</h2>

        <div class="priority-section priority-1">
            <div class="priority-header">
                <span class="priority-badge">PRIORITY 1</span>
                <h3>Immediate Price Adjustment (next 30 days)</h3>
            </div>
            <div class="action-item">
                <div class="action-number">1</div>
                <div class="action-content">
                    <h4>Base increase of 20-30%</h4>
                    <p>To recover lost margin. With cost improvements, a 25% increase would bring you to a margin close to 55%.</p>
                </div>
            </div>
            <div class="action-item">
                <div class="action-number">2</div>
                <div class="action-content">
                    <h4>Staggered strategy:</h4>
                    <ul>
                        <li><strong>Immediate (+20%):</strong> To all new clients and contract renewals</li>
                        <li><strong>30 days (+15%):</strong> To clients with flexible contracts</li>
                        <li><strong>60-90 days (+10-15%):</strong> Negotiation with long-term key clients</li>
                    </ul>
                </div>
            </div>
            <div class="action-item">
                <div class="action-number">3</div>
                <div class="action-content">
                    <h4>Segmentation by sensitivity:</h4>
                    <ul>
                        <li><strong>Luxury hotels (+25-30%):</strong> Lower price sensitivity, prioritize quality</li>
                        <li><strong>Premium restaurants (+20-25%):</strong> Can pass part on to end consumer</li>
                        <li><strong>Sensitive clients (+15-20%):</strong> Negotiate with caution</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="priority-section priority-2">
            <div class="priority-header">
                <span class="priority-badge">PRIORITY 2</span>
                <h3>Supplier Negotiation</h3>
            </div>
            <div class="action-item">
                <div class="action-number">4</div>
                <div class="action-content">
                    <h4>Futures contracts</h4>
                    <p>Lock in coffee prices for 6-12 months to protect yourself from more volatility.</p>
                </div>
            </div>
            <div class="action-item">
                <div class="action-number">5</div>
                <div class="action-content">
                    <h4>Volume discounts</h4>
                    <p>With 25% more sales, you have negotiating power. Seek 5-10% discount.</p>
                </div>
            </div>
            <div class="action-item">
                <div class="action-number">6</div>
                <div class="action-content">
                    <h4>Supplier diversification</h4>
                    <p>Have at least 2-3 suppliers to compare prices and quality.</p>
                </div>
            </div>
        </div>

        <div class="priority-section priority-3">
            <div class="priority-header">
                <span class="priority-badge">PRIORITY 3</span>
                <h3>Mix Optimization</h3>
            </div>
            <div class="action-item">
                <div class="action-number">7</div>
                <div class="action-content">
                    <h4>Promote premium products</h4>
                    <p>Cold Brew maintains the best margin (50.5%). Espresso is also good (45.8%). Incentivize their purchase.</p>
                </div>
            </div>
            <div class="action-item">
                <div class="action-number">8</div>
                <div class="action-content">
                    <h4>Review medium margin products</h4>
                    <p>Whole Bean (45.6%) and Filter (45.1%) are at the limit. Consider targeted price increases or promotion of premium alternatives.</p>
                </div>
            </div>
        </div>

        <div class="priority-section control">
            <div class="priority-header">
                <span class="priority-badge control-badge">CONTROL AND MONITORING</span>
                <h3>Continuous Tracking System</h3>
            </div>
            <div class="action-item">
                <div class="action-number">9</div>
                <div class="action-content">
                    <h4>Weekly dashboard</h4>
                    <p>Monitor margin % every week. If it drops below 43%, yellow alert. If it drops below 40%, red alert.</p>
                </div>
            </div>
            <div class="action-item">
                <div class="action-number">10</div>
                <div class="action-content">
                    <h4>Automatic adjustment clauses</h4>
                    <p>In all new contracts: "If coffee cost increases by more than 20%, the price is automatically adjusted in the same proportion".</p>
                </div>
            </div>
        </div>

        <div class="timeline-section">
            <h3 style="text-align: center; color: #7b2cbf; margin-bottom: 30px;">üìÖ Implementation Timeline</h3>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-marker week1-2">Week 1-2</div>
                    <div class="timeline-content">
                        <h4>Preparation</h4>
                        <ul>
                            <li>Prepare presentation explaining cost increases</li>
                            <li>Segment clients by price sensitivity</li>
                            <li>Update contracts with adjustment clauses</li>
                        </ul>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-marker week3-4">Week 3-4</div>
                    <div class="timeline-content">
                        <h4>Execution</h4>
                        <ul>
                            <li>Conversations with top 10 clients</li>
                            <li>Apply increase to new clients</li>
                            <li>General communication</li>
                        </ul>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-marker month2">Month 2</div>
                    <div class="timeline-content">
                        <h4>Implementation</h4>
                        <ul>
                            <li>Staggered increases by segment</li>
                            <li>Negotiate with suppliers</li>
                            <li>Monitor customer loss (5-10%)</li>
                        </ul>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-marker month3">Month 3</div>
                    <div class="timeline-content">
                        <h4>Evaluation</h4>
                        <ul>
                            <li>Evaluate results</li>
                            <li>Adjust strategy</li>
                            <li>Target: Margin >55%</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <h2 class="section-title">üìä Coffee Market Projections 2026-2027</h2>

        <div class="insight-box" style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-left-color: #3b82f6;">
            <h3 style="color: #1e40af;">üìà International Trends Analysis</h3>
            <p style="color: #1e3a8a; margin-bottom: 15px;">
                <strong>Context of volatility:</strong> The international coffee market presents divergent projections 
                for the next 12-24 months, reflecting uncertainty in climatic, geopolitical and production factors.
            </p>
            
            <div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">
                <h4 style="color: #1e40af; margin-bottom: 12px; font-size: 1.1em;">
                    üè¶ World Bank (October 2025)
                    <a href="https://www.lanacion.com.co/analdex-advierte-caida-en-precio-del-cafe-en-2026/" target="_blank" style="font-size: 0.75em; color: #3b82f6; text-decoration: none; margin-left: 8px;">üìé Source</a>
                </h4>
                <ul style="color: #1e3a8a; line-height: 1.8; margin-left: 20px;">
                    <li><strong>2026:</strong> Estimated 13% reduction in arabica coffee prices due to production recovery in Colombia</li>
                    <li><strong>2027:</strong> Additional 5% decrease</li>
                    <li><strong>Robusta Coffee:</strong> 9% increase in 2025, but 2% drops projected for 2026-2027</li>
                    <li><strong>Upside risks:</strong> Weather disruptions in Brazil and potential U.S. tariffs</li>
                </ul>
            </div>

            <div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">
                <h4 style="color: #1e40af; margin-bottom: 12px; font-size: 1.1em;">
                    üìä WalletInvestor
                    <a href="https://libertex.org/es/blog/cafe-prediccion" target="_blank" style="font-size: 0.75em; color: #3b82f6; text-decoration: none; margin-left: 8px;">üìé Source</a>
                </h4>
                <ul style="color: #1e3a8a; line-height: 1.8; margin-left: 20px;">
                    <li><strong>Sustained upward trend:</strong> Projection of progressive growth of 10-15% annually</li>
                    <li><strong>2026:</strong> Estimated prices of $5.50-6.10/kg</li>
                    <li><strong>2027-2030:</strong> Continuation of upward trajectory due to stable global demand and limited supply</li>
                    <li><strong>Factors:</strong> Sustained international demand and expectations of limited supply</li>
                </ul>
            </div>

            <div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">
                <h4 style="color: #1e40af; margin-bottom: 12px; font-size: 1.1em;">
                    üè¢ Rabobank (November 2025)
                    <a href="https://www.bloomberglinea.com/mercados/las-abundantes-cosechas-aliviaran-precios-del-cacao-y-del-cafe-en-2026-segun-rabobank/" target="_blank" style="font-size: 0.75em; color: #3b82f6; text-decoration: none; margin-left: 8px;">üìé Source</a>
                </h4>
                <ul style="color: #1e3a8a; line-height: 1.8; margin-left: 20px;">
                    <li><strong>Stabilization in wide range:</strong> Arabica prices between $5.50-7.70/kg</li>
                    <li><strong>Expected volatility:</strong> Short-term volatility will persist due to climatic factors</li>
                    <li><strong>Abundant harvests:</strong> Possible price relief in 2026 due to increased global production</li>
                    <li><strong>Warning:</strong> "Agriculture no longer plays by the rules of supply and demand, but geopolitics"</li>
                </ul>
            </div>

            <div style="background: #fef3c7; padding: 20px; border-radius: 10px; margin-top: 20px; border-left: 4px solid #f59e0b;">
                <h4 style="color: #92400e; margin-bottom: 10px; font-size: 1.1em;">‚ö° Conclusion for SSC Gourmet</h4>
                <p style="color: #78350f; line-height: 1.7; margin: 0;">
                    <strong>The consensus indicates continued volatility with two main scenarios:</strong> (1) Temporary 
                    correction of 10-15% if Brazilian harvests improve, or (2) Additional increases of 10-20% if 
                    adverse climate factors persist. Since your current cost is $8.85/kg, a 10-20% increase would 
                    take you to a range of $9.75-10.60/kg. <strong>Recommendation:</strong> Implement preventive price 
                    adjustments now and include automatic adjustment clauses in contracts to protect against any scenario.
                </p>
            </div>
        </div>

        <div class="final-warning">
            <h3>‚ö†Ô∏è Important Considerations</h3>
            <p>A 45.6% margin is close to the healthy limit, but any additional cost increase 
            or loss of key clients could put the business at risk. <strong>It's better to implement 
            preventive adjustments now than wait for a crisis.</strong> The projected volatility in the 
            international coffee market makes it essential to have protection mechanisms in the pricing strategy.</p>
        </div>

    </div>

    <script>
        // Toggle accordion
        function toggleAccordion() {
            document.getElementById('calculationAccordion').classList.toggle('open');
        }

        // Data updated with V4 (corrected costs) - converted to USD at 20 MXN = 1 USD
        const datosMensuales = {
            2024: {
                meses: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                precio: [14.92, 14.24, 14.77, 14.31, 14.51, 14.65, 14.46, 14.30, 14.31, 14.31, 14.61, 14.79],
                costo: [5.83, 5.66, 5.67, 5.72, 5.74, 5.67, 5.67, 5.76, 5.65, 5.72, 5.80, 5.73]
            },
            2025: {
                meses: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                precio: [15.24, 15.61, 15.59, 15.69, 16.31, 15.72, 16.37, 16.07, 16.08, 16.02, 16.07, 16.15],
                costo: [8.88, 8.80, 8.89, 8.75, 8.84, 8.76, 8.77, 8.89, 8.80, 8.81, 8.92, 8.87]
            }
        };

        // Chart 1: Price vs Cost
        const ctx1 = document.getElementById('precioVsCostoChart').getContext('2d');
        new Chart(ctx1, {
            type: 'line',
            data: {
                labels: datosMensuales[2024].meses,
                datasets: [
                    {
                        label: 'Price 2024',
                        data: datosMensuales[2024].precio,
                        borderColor: '#9d4edd',
                        backgroundColor: 'rgba(157, 78, 221, 0.1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true,
                        pointRadius: 0
                    },
                    {
                        label: 'Cost 2024',
                        data: datosMensuales[2024].costo,
                        borderColor: '#fb8500',
                        backgroundColor: 'rgba(251, 133, 0, 0.1)',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        tension: 0.4,
                        fill: true,
                        pointRadius: 0
                    },
                    {
                        label: 'Price 2025',
                        data: datosMensuales[2025].precio,
                        borderColor: '#7b2cbf',
                        backgroundColor: 'rgba(123, 44, 191, 0.1)',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true,
                        pointRadius: 0
                    },
                    {
                        label: 'Cost 2025',
                        data: datosMensuales[2025].costo,
                        borderColor: '#ea580c',
                        backgroundColor: 'rgba(234, 88, 12, 0.1)',
                        borderWidth: 3,
                        borderDash: [5, 5],
                        tension: 0.4,
                        fill: true,
                        pointRadius: 0
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'bottom',
                        labels: {
                            usePointStyle: true,
                            padding: 20,
                            font: { size: 12 }
                        }
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                        callbacks: {
                            label: function(context) {
                                return context.dataset.label + ': $' + context.parsed.y.toFixed(2);
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: false,
                        ticks: {
                            callback: function(value) {
                                return '$' + value;
                            }
                        },
                        grid: {
                            color: 'rgba(0,0,0,0.05)'
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>
